<%
  # Display Actions only if required - 
  # No need to display when called from dashboard
  display_actions = true if display_actions.nil?
%>

<div class="row clearfix">
                    <div class="col-md-12">
                        <div class="card">
                            <div class="mail-inbox">

                                <div class="mobile-left">
                                    <a href="javascript:void(0);" class="btn btn-primary toggle-email-nav"><i class="fa fa-bars"></i></a>
                                </div>

                                <div class="body mail-left">
                                    <div class="mail-side">
                                        <ul id="tree2">
                                            <% if @folders.present? %>
                                            <% @folders.each_with_index do |folder, i| %>
                                            <li><a href="#"><%= folder.title %></a>                            
                                               
                                            </li>
                                            <% end %>
                                            <% end %>
                                        </ul>
                                    </div>
                                </div>
                                <div class="body mail-right check-all-parent">

                                    
                                    <div class="mail-action clearfix m-l-15">
                                        <div class="pull-left">
                                            <div class="fancy-checkbox d-inline-block">
                                                <label>
                                                    <input class="check-all" type="checkbox" name="checkbox">
                                                    <span></span>
                                                </label>
                                            </div>
                                            <a href="javascript:void(0);" class="btn btn-light btn-sm" data-toggle="tooltip" data-placement="top" title="Delete"><i class="icon-trash"></i></a>
                                            <a href="javascript:void(0);" class="btn btn-light btn-sm" data-toggle="tooltip" data-placement="top" title="Archive"><i class="fa fa-archive"></i></a>
                                            <a href="javascript:void(0);" class="btn btn-light btn-sm" data-toggle="tooltip" data-placement="top" title="Refresh"><i class="icon-refresh"></i></a> 
                                            <a href="javascript:void(0);" class="btn btn-light btn-sm" data-toggle="tooltip" data-placement="top" title="Cut"><i class="fa fa-cut"></i> </a>   
                                            <a href="javascript:void(0);" class="btn btn-light btn-sm" data-toggle="tooltip" data-placement="top" title="Copy"><i class="icon-docs"></i> </a>   
                                            <a href="javascript:void(0);" class="btn btn-light btn-sm" data-toggle="tooltip" data-placement="top" title="Paste"><i class="fa fa-paste"></i></a>                                    
                                            
                                            
                                            <div class="btn-group">
                                                <span id="popoverWrapper" data-toggle="tooltip" data-placement="top" data-original-title="Move To">
                                                    <button class="btn btn-light btn-sm dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i class="fa fa-share fa-fw"></i></button>
                                                
                                                    <div class="dropdown-menu">
                                                         <% if @folders.present? %>
                                                        <% @folders.each_with_index do |folder, i| %>
                                                          
                                                          <a class="dropdown-item" data-id="<%= folder.id %>" onClick="move_folder(<%= folder.id %>)" href="#" data-remote="true"><%= folder.title %></a>
                                                      <% end %>
                                                       <%end%>
                                                       
                                                        <div role="separator" class="dropdown-divider"></div>
                                                        <a class="dropdown-item" href="#foldermmodal" data-toggle="modal" data-target="#foldermmodal">Create New</a>
                                                        <a class="dropdown-item" href="#">Archive</a>
                                                        <a class="dropdown-item" href="#">Delete</a>
                                                      </div>                                              
                                                
                                                </span>
                                            </div>
                                        </div>
                                        <div class="pull-right ml-auto">
                                            <div class="pagination-email d-flex">
                                                <p>1-50/295</p>
                                                <div class="btn-group m-l-20">
                                                    <button type="button" class="btn btn-default btn-sm"><i class="fa fa-angle-left"></i></button>
                                                    <button type="button" class="btn btn-default btn-sm"><i class="fa fa-angle-right"></i></button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    
                                    <div class="table-responsive">
                                        <table class="table table-hover table-custom spacing8">
                                            <thead>
                                                <tr> 
                                                    <th></th>
                                                    <th>#</th>
                                                    <th>Name</th>
                                                    <th>Size</th>
                                                    <th>Created date</th>
                                                    <th>Last updated on</th>
                                                    <th>Folder</th>
                                                </tr>
                                            </thead>
                                            <tbody  oncontextmenu ="event.preventDefault();$('#context-menu').show();$('#context-menu').offset({'top':mouseY,'left':mouseX})">
                                      <% @documents.each_with_index do |document, i| %>
                                                  <% 
                                                  if document.doc_type == "template_document"
                                                    icon_path = "icons/template.svg"
                                                    doc_url = user_template_document_path(document)
                                                    doc_status_removed_url = update_status_user_template_document_path(document, status: 'removed') 
                                                    doc_status_archive_url = update_status_user_template_document_path(document, status: 'archived')
                                                    doc_type="Template Based"
                                                    doc_folder=update_template_folder_user_template_document_path(document)
                                                  elsif document.doc_type == "table_document"
                                                    icon_path = "icons/excel.svg"
                                                    doc_url = user_table_document_path(document) 
                                                    doc_status_removed_url = update_status_user_table_document_path(document, status: 'removed')
                                                    doc_status_archive_url = update_status_user_table_document_path(document, status: 'archived')
                                                    doc_type="Table Based"
                                                    doc_folder=update_table_folder_user_table_document_path(document)
                                                  else
                                                    doc_url = "#"
                                                    doc_status_removed_url = "#"
                                                    doc_status_archive_url = "#"
                                                    doc_type=""
                                                  end
                                                  %>
                                                
                                                <tr>
                                                    <td class="w20">
                                                        <div class="md-left">
                                                            <label class="fancy-checkbox">
                                                                <input type="checkbox" name="doc_name[]" value="<%=doc_folder%>" class="checkbox-tick">
                                                                <span></span>
                                                            </label>
                                                        </div>
                                                    </td>
                                                    <td class="w60"><%= serial_number(i) %></td>
                                                    <td>
                                                        <%= link_to document.title, doc_url, title: document.title %>
                                                        <p class="mb-0"><%=doc_type%></p>
                                                    </td>
                                                    <td>
                                                        <span></span>
                                                    </td>
                                                    <td><%= document.created_at.strftime("%d %b %Y - %I:%M %p") %></td>
                                                    <td><%= document.updated_at.strftime("%d %b %Y - %I:%M %p") %></td>
                                                    <td><strong><%=document.folder.title%></strong></td>
                                                </tr>
                                                
                                                <% end %>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

    


    <div class="context-menu" id="context-menu" style="display:none;position:absolute;z-index:99">
        <ul>
          <li><a href="#"><i class="icon-trash"></i>  Delete</a></li>       
          <li><a href="#"><i class="fa fa-archive"></i> Archive</a></li>       
          <li><a href="#"><i class="fa fa-cut"></i> Cut</a></li>  
          <li><a href="#"><i class="fa fa-files-o"></i> Copy</a></li> 
          <li><a href="#"><i class="fa fa-paste"></i> Paste</a></li>      
          <li><a href="#"><i class="fa fa-share fa-fw"></i> Move</a>
                <ul class="context-menu-dd">
                    <li><a href="#">Folder 01</a></li>
                    <li><a href="#">Folder 02</a></li>
                    <li><a href="#">Folder 03</a></li>
                </ul>
          </li>       
                
        </ul>
    </div>
<div class="modal fade foldermmodal" tabindex="-1" role="dialog" aria-labelledby="foldermmodal" aria-hidden="true" id="foldermmodal">
  <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true"><b style="color:#fb3600; font-weight:700;">X</b></button><!--&times;-->
                            <h4 class="modal-title text-center" id="addContact">Add Folder</h4>
                        </div>
                        <div class="modal-body">
                            <div class="row">
                                <form id="requestacallform"  method="POST" name="requestacallform">
                                    
                                <div class="form-group">
                                  <div class="input-group">                               
                                    
                                    <input id="title" type="text" class="form-control" placeholder="Folder Name" name="title"/>
                                    <input id="user_id" type="hidden" class="form-control"  name="user_id" value="<%=@client_user%>"/>
                                  </div>
                                </div>
                                
                                

                            </div>
                        </div>
                        <div class="modal-footer">
                            <a class="btn btn-info" data-dismiss="modal">Close</a>
                            <button type="button" id="folder-form" class="btn btn-blue">Submit</button>
                        </div>
                    </form>
                    </div>
                </div>
</div>