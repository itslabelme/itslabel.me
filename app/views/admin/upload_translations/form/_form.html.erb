

<%
  form_url = admin_upload_translations_url
  # form_url = {action: :csv_parse}
  form_method = :post
%>




<div class="body">
  
  <%= form_with(url: form_url,  class: "form-floating", multipart: true,  method: form_method) do |f| %>

    <span>
      <strong style="font-size:16px;">Step 2: Upload CSV</strong>
    </span>
      <!-- Display Errors if Any -->
      <div id="UPLOAD_CSV_FORM_ERRORS">
        <div class="row">
          <div class="col-md-12 pt-3">
            <% unless @parsing_status[:total_rows] == 0 %>
              <div class="alert alert-secondary alert-dismissible fade show" role="alert">
                <p>Total number of rows parsed : <%= @parsing_status[:total_rows] %>, Missed Rows: <%= @parsing_status[:num_missing_rows] %></p>
                <p>Missing Rows : 

                  Rows with element
                  <% @parsing_status[:missed_rows].each_with_index do | missed_row, i | %>
                     <%= "#{missed_row},"%>
                  <% end %>
                  
                </p>
                <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <% end %>
          </div>
          <div class="col-md-12 pt-3">
            <% unless @summary.empty? %>
              <div class="alert alert-success alert-dismissible fade show">
                <table>
                    <tr>
                      <th style="width: 25%" scope="col">English Word</th>
                      <th style="width: 75%" scope="col">Inserted Compination</th>
                    </tr>
            
                  <% @summary.each_with_index do | (key, value), index | %>
                    <tr>
                      <td><%= key %></td>
                      <td>
                          <% value.each_with_index do | (k, v), index | %>
                            <%= k %> 
                            <% if value.length > index + 1 %> , <% end %>
                          <% end %>
                        </td>
                    </tr>


                  <% end %>

                </table>

                <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
            <% end %>
          </div>
          <div class="col-md-12 pt-3">
            <% unless @errors.empty? %>
              <div class="alert alert-danger alert-dismissible fade show" role="alert">
                <table class="table-bordered">
                    <tr>
                      <th style="width: 25%" scope="col">English Word</th>
                      <th style="width: 75%" scope="col">Inserted Compination</th>
                    </tr>
            
                  <% @errors.each_with_index do | (key, value), index | %>
                    <tr>
                      <td><%= key %></td>
                      <td>
                          <% value.each_with_index do | (k, v), index | %>
                            <%= k %> 
                            <% if value.length > index + 1 %> <br> <% end %>
                          <% end %>
                        </td>
                    </tr>


                  <% end %>

                </table>
                <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
            <% end %>
          </div>
        </div>
      </div>


      <!-- File -->
      <div class="row">
        <div class="col-md-12 pt-3">
          <div class="row its-language-switcer mb-2">
            <div class="col-md-12">
              <div class="alert alert-info">
                <p><strong>Please Note the Following:</strong></p>
                <p>* It shoud be a <span class='badge badge-info'>CSV</span> file (Comma Separated File).</p>
              </div>
            </div>
          </div>
        </div>
        <div class="col-md-12 pb-3 pt-3">
          <div class="form-group row " style="">
            <label class="col-sm-12">Click below to upload from your computer
              <span class="text-color-red px-1">&nbsp;&nbsp;</span>
            </label>
            <div class="col-md-12">
              <%= file_field_tag :file %>
            </div>
          </div>
        </div>
      </div>
      <button type="submit" class="btn btn-primary"><span class="fa fa-upload"></span> Upload </button>
  <% end %>
</div>
